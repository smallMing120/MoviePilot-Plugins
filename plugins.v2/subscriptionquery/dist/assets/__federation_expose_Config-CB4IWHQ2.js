import{i as R}from"./vuetify-lib-vmanpUDa.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{createTextVNode:f,resolveComponent:n,withCtx:a,createVNode:t,toDisplayString:F,openBlock:k,createBlock:K,createCommentVNode:z,withModifiers:J,createElementBlock:X}=await R("vue"),Y={class:"plugin-config"},{ref:m,reactive:Z,onMounted:$,watch:h}=await R("vue"),ee={__name:"Config",props:{initialConfig:{type:Object,default:()=>({})},api:{type:Object,default:()=>{}}},emits:["save","close","switch"],setup(B,{emit:H}){const d=B,S=m(null),_=m(!0),p=m(null),x=m(!1),O=[{text:"全部",value:""},{text:"蓝光原盘",value:"Blu-?Ray.+VC-?1|Blu-?Ray.+AVC|UHD.+blu-?ray.+HEVC|MiniBD"},{text:"Remux",value:"Remux"},{text:"BluRay",value:"Blu-?Ray"},{text:"UHD",value:"UHD|UltraHD"},{text:"WEB-DL",value:"WEB-?DL|WEB-?RIP"},{text:"HDTV",value:"Blu-?Ray"},{text:"H265",value:"[Hx].?265|HEVC"},{text:"H264",value:"[Hx].?264|AVC"}],E=[{text:"全部",value:""},{text:"4K",value:"4K|2160p|x2160"},{text:"1080P",value:"1080[pi]|x1080"},{text:"720P",value:"720[pi]|x720"}],q=[{text:"全部",value:""},{text:"杜比视界",value:"Dolby[\\s.]+Vision|DOVI|[\\s.]+DV[\\s.]+"},{text:"杜比全景声",value:"Dolby[\\s.]*\\+?Atmos|Atmos"},{text:"HDR",value:"[\\s.]+HDR[\\s.]+|HDR10|HDR10\\+"},{text:"SDR",value:"[\\s.]+SDR[\\s.]+"}],D=m([]),w=m([]),C=m([]),l=Z({...{subscribe_id:0,keyword:"",start_episode:"",quality:"",resolution:"",effect:"",sites:[],include:"",exclude:"",filter_groups:[],media_category:"",best_version:!1,search_imdbid:!1,search:!1,update:!1,custom_words:""}});$(()=>{d.initialConfig&&Object.keys(d.initialConfig).forEach(i=>{i in l&&(l[i]=d.initialConfig[i])}),I()});async function I(){const i=await d.api.get("plugin/SubscriptionQuery/getSiteList");i?D.value=i.map(s=>({text:s.text,value:s.value})):console.log("获取站点列表失败:");const e=await d.api.get("plugin/SubscriptionQuery/getSubscribeList");e?w.value=e.map(s=>({text:s.text,value:s.value})):console.log("获取订阅列表失败:");const b=await d.api.get("plugin/SubscriptionQuery/getFilterRuleGroupsList");b?C.value=b.map(s=>({text:s.text,value:s.value})):console.log("获取优先级规则组列表失败:")}const y=H;async function U(){if(!_.value){p.value="请修正表单错误";return}x.value=!0,p.value=null;try{await new Promise(i=>setTimeout(i,1e3)),y("save",{...l})}catch(i){console.error("保存配置失败:",i),p.value=i.message||"保存配置失败"}finally{x.value=!1}}h(()=>l.subscribe_id,(i,e)=>{console.log("订阅ID变化:",i,e),i!=e&&i!=0&&e!=0&&N(i)});async function N(i){const e=await d.api.get("plugin/SubscriptionQuery/getSubscribe?apikey="+d.initialConfig.apikey+"&subscribe_id="+i);e&&(l.keyword=e.keyword,l.start_episode=e.start_episode,l.quality=e.quality,l.resolution=e.resolution,l.effect=e.effect,l.sites=e.sites,l.include=e.include,l.exclude=e.exclude,l.filter_groups=e.filter_groups,l.media_category=e.media_category,l.best_version=e.best_version,l.search_imdbid=e.search_imdbid)}function L(){y("switch")}function M(){y("close")}return(i,e)=>{const b=n("v-card-title"),s=n("v-alert"),c=n("v-select"),u=n("v-col"),r=n("v-row"),v=n("v-text-field"),V=n("v-switch"),A=n("v-textarea"),P=n("v-form"),Q=n("v-card-text"),g=n("v-btn"),T=n("v-spacer"),j=n("v-card-actions"),G=n("v-card");return k(),X("div",Y,[t(G,null,{default:a(()=>[t(b,null,{default:a(()=>e[17]||(e[17]=[f("插件配置")])),_:1}),t(Q,null,{default:a(()=>[p.value?(k(),K(s,{key:0,type:"error",class:"mb-4"},{default:a(()=>[f(F(p.value),1)]),_:1})):z("",!0),t(P,{ref_key:"form",ref:S,modelValue:_.value,"onUpdate:modelValue":e[16]||(e[16]=o=>_.value=o),onSubmit:J(U,["prevent"])},{default:a(()=>[t(r,null,{default:a(()=>[t(u,{cols:"12",md:"12"},{default:a(()=>[t(c,{modelValue:l.subscribe_id,"onUpdate:modelValue":e[0]||(e[0]=o=>l.subscribe_id=o),label:"订阅",items:w.value,variant:"outlined","item-title":"text","item-value":"value"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"8"},{default:a(()=>[t(v,{modelValue:l.keyword,"onUpdate:modelValue":e[1]||(e[1]=o=>l.keyword=o),label:"关键词",variant:"outlined",hint:"搜索关键词"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"4"},{default:a(()=>[t(v,{modelValue:l.start_episode,"onUpdate:modelValue":e[2]||(e[2]=o=>l.start_episode=o),label:"开始集数",variant:"outlined",hint:"开始集数"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"4"},{default:a(()=>[t(c,{modelValue:l.quality,"onUpdate:modelValue":e[3]||(e[3]=o=>l.quality=o),label:"质量",items:O,variant:"outlined","item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"4"},{default:a(()=>[t(c,{modelValue:l.resolution,"onUpdate:modelValue":e[4]||(e[4]=o=>l.resolution=o),label:"分辨率",items:E,variant:"outlined","item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"4"},{default:a(()=>[t(c,{modelValue:l.effect,"onUpdate:modelValue":e[5]||(e[5]=o=>l.effect=o),label:"特效",items:q,variant:"outlined","item-title":"text","item-value":"value"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"12"},{default:a(()=>[t(c,{modelValue:l.sites,"onUpdate:modelValue":e[6]||(e[6]=o=>l.sites=o),label:"站点",variant:"outlined","item-title":"text","item-value":"value",items:D.value,multiple:"true",chips:"true"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:l.include,"onUpdate:modelValue":e[7]||(e[7]=o=>l.include=o),label:"包含",variant:"outlined",hint:"包含（关键字、正则式）"},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:l.exclude,"onUpdate:modelValue":e[8]||(e[8]=o=>l.exclude=o),label:"排除",variant:"outlined",hint:"排除（关键字、正则式）"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:l.filter_groups,"onUpdate:modelValue":e[9]||(e[9]=o=>l.filter_groups=o),label:"优先级规则组",variant:"outlined",hint:"优先级规则组",items:C.value,multiple:"true",chips:"true","item-title":"text","item-value":"value"},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12",md:"6"},{default:a(()=>[t(v,{modelValue:l.media_category,"onUpdate:modelValue":e[10]||(e[10]=o=>l.media_category=o),label:"自定义类别",variant:"outlined",hint:"自定义类别"},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"3"},{default:a(()=>[t(V,{modelValue:l.best_version,"onUpdate:modelValue":e[11]||(e[11]=o=>l.best_version=o),label:"洗版",color:"primary",inset:"","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"3"},{default:a(()=>[t(V,{modelValue:l.search_imdbid,"onUpdate:modelValue":e[12]||(e[12]=o=>l.search_imdbid=o),label:"使用IMDB ID搜索",color:"primary",inset:"","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"3"},{default:a(()=>[t(V,{modelValue:l.search,"onUpdate:modelValue":e[13]||(e[13]=o=>l.search=o),label:"保存后开始搜索",color:"primary",inset:"","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(u,{cols:"12",md:"3"},{default:a(()=>[t(V,{modelValue:l.update,"onUpdate:modelValue":e[14]||(e[14]=o=>l.update=o),label:"更新至订阅并清空",color:"primary",inset:"","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1}),t(r,null,{default:a(()=>[t(u,{cols:"12",md:"12"},{default:a(()=>[t(A,{modelValue:l.custom_words,"onUpdate:modelValue":e[15]||(e[15]=o=>l.custom_words=o),label:"自定义识别词",variant:"outlined",rows:"3",hint:"自定义识别词"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(j,null,{default:a(()=>[t(g,{color:"secondary",onClick:L},{default:a(()=>e[18]||(e[18]=[f("查看数据")])),_:1}),t(T),t(g,{color:"primary",disabled:!_.value,onClick:U,loading:x.value},{default:a(()=>e[19]||(e[19]=[f("保存配置")])),_:1},8,["disabled","loading"]),t(g,{color:"primary",onClick:M},{default:a(()=>e[20]||(e[20]=[f("关闭")])),_:1})]),_:1})]),_:1})])}}},ae=W(ee,[["__scopeId","data-v-5e0b6d0f"]]);export{ae as default};
